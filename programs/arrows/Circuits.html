<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Circuits</title>
    <link rel="stylesheet" href="../../css/default.css" type="text/css" media="screen" title="default">
    <link rel="stylesheet" href="../../css/syntax.css" type="text/css">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Troels Henriksen's piece of the web.  Mostly about programming.">
    <meta name="keywords" content="Braintwist, Brainfuck, Lisp, Common Lisp Troels Henriksen, Brainfork, Esoteric programming language, programming, Haskell, functional programming, Futhark">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <div id="header">
      <div class="superHeader">

        <div class="right">
          <span class="doNotDisplay">Related sites:</span>
          <ul>
            <li><a href="https://github.com/Athas/sigkill.dk">github</a></li>
            
            <li><a href="../.././programs/arrows/Circuits.lhs">source</a></li>
            
          </ul>
        </div>

      </div>

      <div class="midHeader">
        <h1 class="headerTitle"><a href="../../">SIGKILL <span id="headerSubTitle">-9</span></a></h1>
      </div>

      <div class="subHeader">
        <ul class="menu0"><li><a href="../../blog/">blog/</a></li><li><a href="../../hacks/">hacks/</a></li><li><a href="../../links.html">links</a></li><li><a href="../../me/">me/</a></li><li><a href="../../programs/" class="thisPage">programs/</a></li><li><a href="../../projects/">projects/</a></li><li><a href="../../writings/">writings/</a></li></ul><ul class="menu1"><li><a href="../../programs/arrows/" class="thisPage">arrows/</a></li><li><a href="../../programs/sigkill.html">sigkill</a></li><li><a href="../../programs/stepping.html">stepping</a></li></ul><ul class="menu2"><li><a href="../../programs/arrows/Circuits.html" class="thisPage">Circuits</a></li><li><a href="../../programs/arrows/Sim.html">Sim</a></li></ul>
      </div>
    </div>

    <div id="content">
      <h1 id="circuit-arrows"><a href="#circuit-arrows" id="circuit-arrows-link" class="titlelink" title="circuit-arrows">Circuit arrows</a></h1>
<p>Simple update of the circuit arrows from <em>Programming with Arrows</em> to work with the modern Arrow libraries.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">module</span> <span class="dt">Circuits</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">import</span> <span class="dt">Control.Arrow</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">import</span> <span class="dt">Data.List</span></a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">class</span> <span class="dt">ArrowLoop</span> a <span class="ot">=&gt;</span> <span class="dt">ArrowCircuit</span> a <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="ot">  delay ::</span> b <span class="ot">-&gt;</span> a b b</a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="ot">nor ::</span> <span class="dt">Arrow</span> a <span class="ot">=&gt;</span> a (<span class="dt">Bool</span>,<span class="dt">Bool</span>) <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb1-10" title="10">nor <span class="fu">=</span> arr (<span class="fu">not.uncurry</span> (<span class="fu">||</span>))</a>
<a class="sourceLine" id="cb1-11" title="11"></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="ot">flipflop ::</span> <span class="dt">ArrowCircuit</span> a <span class="ot">=&gt;</span> a (<span class="dt">Bool</span>,<span class="dt">Bool</span>) (<span class="dt">Bool</span>,<span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb1-13" title="13">flipflop <span class="fu">=</span> loop (arr (\((a,b),(c,d)) <span class="ot">-&gt;</span> ((a,d),(b,c))) <span class="fu">&gt;&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-14" title="14">                 nor <span class="fu">***</span> nor <span class="fu">&gt;&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-15" title="15">                 delay (<span class="dt">False</span>,<span class="dt">True</span>) <span class="fu">&gt;&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-16" title="16">                 arr <span class="fu">id</span> <span class="fu">&amp;&amp;&amp;</span> arr <span class="fu">id</span>)</a>
<a class="sourceLine" id="cb1-17" title="17"></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="kw">class</span> <span class="dt">Signal</span> a <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="ot">  showSignal ::</span> [a] <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb1-20" title="20"></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="kw">instance</span> <span class="dt">Signal</span> <span class="dt">Bool</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-22" title="22">  showSignal bs <span class="fu">=</span> <span class="fu">concat</span> top<span class="fu">++</span><span class="st">&quot;\n&quot;</span><span class="fu">++concat</span> bot<span class="fu">++</span><span class="st">&quot;\n&quot;</span></a>
<a class="sourceLine" id="cb1-23" title="23">    <span class="kw">where</span> (top,bot) <span class="fu">=</span> <span class="fu">unzip</span> (<span class="fu">zipWith</span> sh (<span class="dt">False</span><span class="fu">:</span>bs) bs)</a>
<a class="sourceLine" id="cb1-24" title="24">          sh <span class="dt">True</span> <span class="dt">True</span> <span class="fu">=</span> (<span class="st">&quot;__&quot;</span>,<span class="st">&quot;  &quot;</span>)</a>
<a class="sourceLine" id="cb1-25" title="25">          sh <span class="dt">True</span> <span class="dt">False</span> <span class="fu">=</span> (<span class="st">&quot;  &quot;</span>,<span class="st">&quot;|_&quot;</span>)</a>
<a class="sourceLine" id="cb1-26" title="26">          sh <span class="dt">False</span> <span class="dt">True</span> <span class="fu">=</span> (<span class="st">&quot; _&quot;</span>,<span class="st">&quot;| &quot;</span>)</a>
<a class="sourceLine" id="cb1-27" title="27">          sh <span class="dt">False</span> <span class="dt">False</span> <span class="fu">=</span> (<span class="st">&quot;  &quot;</span>,<span class="st">&quot;__&quot;</span>)</a>
<a class="sourceLine" id="cb1-28" title="28"></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="kw">instance</span> (<span class="dt">Signal</span> a,<span class="dt">Signal</span> b) <span class="ot">=&gt;</span> <span class="dt">Signal</span> (a,b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-30" title="30">  showSignal xys <span class="fu">=</span> showSignal (<span class="fu">map</span> <span class="fu">fst</span> xys)<span class="fu">++</span>showSignal (<span class="fu">map</span> <span class="fu">snd</span> xys)</a>
<a class="sourceLine" id="cb1-31" title="31"></a>
<a class="sourceLine" id="cb1-32" title="32"><span class="kw">instance</span> <span class="dt">Signal</span> a <span class="ot">=&gt;</span> <span class="dt">Signal</span> [a] <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-33" title="33">  showSignal <span class="fu">=</span> <span class="fu">concatMap</span> showSignal <span class="fu">.</span> transpose</a>
<a class="sourceLine" id="cb1-34" title="34"></a>
<a class="sourceLine" id="cb1-35" title="35"><span class="ot">sig ::</span> [(<span class="dt">Int</span>, a)] <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb1-36" title="36">sig <span class="fu">=</span> <span class="fu">concatMap</span> (<span class="fu">uncurry</span> <span class="fu">replicate</span>)</a>
<a class="sourceLine" id="cb1-37" title="37"></a>
<a class="sourceLine" id="cb1-38" title="38"><span class="ot">flipflopInput ::</span> [(<span class="dt">Bool</span>, <span class="dt">Bool</span>)]</a>
<a class="sourceLine" id="cb1-39" title="39">flipflopInput <span class="fu">=</span> sig</a>
<a class="sourceLine" id="cb1-40" title="40">        [(<span class="dv">5</span>,(<span class="dt">False</span>,<span class="dt">False</span>)),(<span class="dv">2</span>,(<span class="dt">False</span>,<span class="dt">True</span>)),(<span class="dv">5</span>,(<span class="dt">False</span>,<span class="dt">False</span>)),</a>
<a class="sourceLine" id="cb1-41" title="41">         (<span class="dv">2</span>,(<span class="dt">True</span>,<span class="dt">False</span>)),(<span class="dv">5</span>,(<span class="dt">False</span>,<span class="dt">False</span>)),(<span class="dv">2</span>,(<span class="dt">True</span>,<span class="dt">True</span>)),</a>
<a class="sourceLine" id="cb1-42" title="42">         (<span class="dv">6</span>,(<span class="dt">False</span>,<span class="dt">False</span>))]</a></code></pre></div>
    </div>

    <div id="footer">
      <a href="http://jaspervdj.be/hakyll/index.html" id="hakyllLink">Powered by Hakyll</a>

      <span id="dates">
        
        
      </span>
    </div>
  </body>
</html>
